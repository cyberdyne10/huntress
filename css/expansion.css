.soc-preview-page {
  --soc-bg-0: #060b17;
  --soc-bg-1: #0a1326;
  --soc-bg-2: #0e1d35;
  --soc-surface: rgb(10 21 40 / 70%);
  --soc-surface-2: rgb(14 28 51 / 78%);
  --soc-border: rgb(125 211 252 / 18%);
  --soc-text: #eaf3ff;
  --soc-muted: #95a7c4;
  --soc-accent: #40d8ff;
  --soc-accent-2: #6df0ff;
  --soc-danger: #ff4d6d;
  --soc-shadow: 0 22px 54px rgb(2 6 23 / 46%);
}

.soc-preview-page .page-hero {
  padding: 84px 0 48px;
  background:
    radial-gradient(circle at 6% 4%, rgb(109 240 255 / 20%), transparent 25%),
    radial-gradient(circle at 88% 10%, rgb(72 61 255 / 20%), transparent 28%),
    linear-gradient(120deg, var(--soc-bg-0), var(--soc-bg-1) 48%, var(--soc-bg-2));
  border-bottom: 1px solid rgb(125 211 252 / 14%);
}

.soc-preview-page .hero-chip {
  display: inline-flex;
  margin-bottom: 14px;
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid rgb(125 211 252 / 30%);
  background: rgb(64 216 255 / 10%);
  color: #b6ecff;
  font-size: 0.76rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.soc-preview-page .page-hero h1 {
  font-size: clamp(2rem, 4vw, 2.8rem);
  letter-spacing: -0.028em;
  line-height: 1.08;
  margin-bottom: 12px;
}

.soc-preview-page .page-hero p {
  max-width: 64ch;
  color: var(--soc-muted);
}

.soc-preview-page .section-block { padding: 28px 0; }

.soc-preview-page .split-grid {
  display: grid;
  grid-template-columns: 1.05fr 1fr;
  gap: 20px;
}

.soc-preview-page .card {
  background: linear-gradient(180deg, rgb(255 255 255 / 5%), rgb(255 255 255 / 1%));
  border: 1px solid var(--soc-border);
  border-radius: 16px;
  padding: 18px;
  backdrop-filter: blur(8px);
  box-shadow: var(--soc-shadow);
}

.soc-preview-page .panel { display: flex; flex-direction: column; gap: 16px; }

.soc-preview-page .panel-head { display: flex; justify-content: space-between; align-items: baseline; gap: 12px; }
.soc-preview-page .panel-head h2,
.soc-preview-page .panel-head h3 { font-size: 1.1rem; letter-spacing: -0.015em; }
.soc-preview-page .panel-head-sub { margin-top: 4px; }

.soc-preview-page .small { color: var(--soc-muted); font-size: 0.84rem; }

.soc-preview-page .kpis {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
}

.soc-preview-page .kpi {
  padding: 15px;
  border-radius: 14px;
  border: 1px solid var(--soc-border);
  background: linear-gradient(160deg, rgb(64 216 255 / 12%), rgb(13 24 44 / 90%));
  box-shadow: inset 0 0 0 1px rgb(255 255 255 / 3%);
}

.soc-preview-page .kpi strong { font-size: 1.6rem; letter-spacing: -0.02em; }

.soc-preview-page .chart-bars {
  display: flex;
  gap: 8px;
  align-items: flex-end;
  height: 140px;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid rgb(125 211 252 / 14%);
  background: linear-gradient(180deg, rgb(5 15 30 / 86%), rgb(6 11 23 / 94%));
}

.soc-preview-page .bar {
  flex: 1;
  border-radius: 7px 7px 3px 3px;
  background: linear-gradient(180deg, #6df0ff, #3d7bff 75%);
  box-shadow: 0 0 14px rgb(64 216 255 / 26%);
  transition: transform 200ms ease;
}

.soc-preview-page .bar:hover { transform: translateY(-2px); }

.soc-preview-page .filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 10px; }
.soc-preview-page .filters .active,
.soc-preview-page .map-controls .active {
  background: linear-gradient(140deg, #53dcff, #7d74ff);
  border-color: rgb(125 211 252 / 40%);
  color: #04060b;
}

.soc-preview-page .btn-sm { min-height: 34px; padding: 7px 11px; font-size: 0.84rem; }

.soc-preview-page .input,
.soc-preview-page select,
.soc-preview-page textarea {
  width: 100%;
  padding: 11px;
  border-radius: 10px;
  border: 1px solid rgb(125 211 252 / 30%);
  background: rgb(7 16 31 / 92%);
  color: var(--soc-text);
}

.soc-preview-page .input:focus,
.soc-preview-page button:focus-visible,
.soc-preview-page select:focus-visible {
  outline: 2px solid var(--soc-accent);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgb(64 216 255 / 22%);
}

.soc-preview-page .form-grid { display: grid; gap: 12px; grid-template-columns: 1fr; }
.soc-preview-page .form-grid-inline { grid-template-columns: repeat(3, minmax(160px, 1fr)) auto; align-items: end; }

.soc-preview-page .list { display: grid; gap: 10px; }
.soc-preview-page .list-item {
  border: 1px solid rgb(125 211 252 / 18%);
  border-radius: 12px;
  padding: 12px;
  background: linear-gradient(165deg, rgb(13 28 50 / 65%), rgb(8 16 30 / 88%));
  display: grid;
  gap: 5px;
  transition: transform 160ms ease, border-color 160ms ease;
}

.soc-preview-page .list-item:hover {
  transform: translateY(-2px);
  border-color: rgb(125 211 252 / 36%);
}

.soc-preview-page .list-item-header { display: flex; justify-content: space-between; gap: 10px; align-items: center; }
.soc-preview-page .timeline-list .list-item { border-left: 3px solid rgb(64 216 255 / 56%); }

.soc-preview-page .map-controls { display: flex; gap: 8px; flex-wrap: wrap; }
.soc-preview-page .map-controls-grid { display: grid; grid-template-columns: repeat(6, minmax(0, 1fr)); gap: 8px; align-items: center; }
.soc-preview-page .map-control-inline { margin-bottom: -6px; }
.soc-preview-page .input-sm { min-height: 34px; padding: 6px 9px; }
.soc-preview-page .map-severity-group { grid-column: 1 / -1; display: flex; gap: 8px; flex-wrap: wrap; }

.soc-preview-page .map-live-metrics { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 10px; }
.soc-preview-page .map-live-metrics > div {
  border: 1px solid rgb(125 211 252 / 18%);
  border-radius: 10px;
  padding: 9px;
  background: rgb(2 9 20 / 72%);
  display: grid;
  gap: 3px;
}
.soc-preview-page .map-live-metrics strong { color: #b8f6ff; font-size: 0.97rem; }

.soc-preview-page .map-meta { display: flex; flex-wrap: wrap; gap: 10px; justify-content: flex-end; }

.soc-preview-page .threat-map {
  min-height: 320px;
  height: min(58vh, 540px);
  border-radius: 14px;
  border: 1px solid rgb(64 216 255 / 28%);
  background: radial-gradient(circle at 50% 45%, rgb(16 78 115 / 24%), transparent 50%), linear-gradient(180deg, #071323, #040913);
  overflow: hidden;
  box-shadow: inset 0 0 56px rgb(64 216 255 / 9%), 0 14px 32px rgb(2 6 23 / 52%);
}

.soc-preview-page .threat-map .leaflet-container { width: 100%; height: 100%; min-height: inherit; background: transparent; font-family: inherit; }
.soc-preview-page .threat-map .leaflet-control-zoom a { background: rgb(12 22 40 / 90%); color: #dbeafe; border-color: rgb(125 211 252 / 40%); }
.soc-preview-page .threat-map .leaflet-control-attribution { background: rgb(2 6 23 / 72%); color: #93c5fd; }
.soc-preview-page .threat-map .leaflet-tooltip {
  background: rgb(2 6 23 / 92%);
  color: #bae6fd;
  border: 1px solid rgb(125 211 252 / 35%);
  box-shadow: 0 6px 18px rgb(2 6 23 / 45%);
}

.soc-preview-page .map-legend { display: flex; gap: 12px; flex-wrap: wrap; color: var(--soc-muted); font-size: 0.82rem; }
.soc-preview-page .dot { width: 9px; height: 9px; display: inline-block; border-radius: 50%; margin-right: 5px; }
.soc-preview-page .dot-critical { background: #ff4d6d; }
.soc-preview-page .dot-high { background: #ff8a3d; }
.soc-preview-page .dot-medium { background: #f7c948; }
.soc-preview-page .dot-low { background: #3ddc97; }
.soc-preview-page .dot-arc { background: #4db8ff; }
.soc-preview-page .dot-pulse { border: 1px solid #7dd3fc; background: transparent; }

.soc-preview-page .map-node {
  position: relative;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid rgb(255 255 255 / 54%);
  box-shadow: 0 0 12px currentcolor;
}

.soc-preview-page .map-node::before,
.soc-preview-page .map-node::after {
  content: "";
  position: absolute;
  inset: -4px;
  border-radius: 50%;
  border: 1px solid currentcolor;
  opacity: 0.4;
}

.soc-preview-page .map-node::after {
  inset: -9px;
  opacity: 0.18;
}

.soc-preview-page .map-node-origin { animation: pulse-orbit 2.1s ease-out infinite; }
.soc-preview-page .map-node-target { opacity: 0.9; }
.soc-preview-page .map-tracer {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  border: 1px solid rgb(255 255 255 / 72%);
  box-shadow: 0 0 8px currentcolor;
}

.soc-preview-page .map-flow-line { stroke-linecap: round; }
.soc-preview-page .map-flow-line-glow {
  stroke-linecap: round;
  filter: blur(1px) drop-shadow(0 0 8px rgb(64 216 255 / 48%));
}

.soc-preview-page .loading-skeleton {
  position: relative;
  overflow: hidden;
}

.soc-preview-page .loading-skeleton::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(110deg, transparent, rgb(255 255 255 / 12%), transparent);
  animation: shimmer 1.2s linear infinite;
}

.badge {
  display: inline-block;
  border: 1px solid;
  padding: 3px 8px;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: capitalize;
}

.badge-critical { background: rgb(239 68 68 / 18%); color: #fecaca; border-color: rgb(239 68 68 / 60%); }
.badge-high { background: rgb(249 115 22 / 18%); color: #fdba74; border-color: rgb(249 115 22 / 60%); }
.badge-medium { background: rgb(250 204 21 / 16%); color: #fde68a; border-color: rgb(250 204 21 / 55%); }
.badge-low { background: rgb(34 197 94 / 16%); color: #bbf7d0; border-color: rgb(34 197 94 / 55%); }

@keyframes pulse-orbit {
  0% { transform: scale(0.88); opacity: 0.8; }
  65% { transform: scale(1.12); opacity: 0.32; }
  100% { transform: scale(0.88); opacity: 0.8; }
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.threat-intel-section .threat-intel-card {
  padding: clamp(16px, 2.4vw, 24px);
  border-radius: 18px;
  border-color: rgb(125 211 252 / 18%);
  background: transparent;
  box-shadow: none;
  display: grid;
  gap: 12px;
}

.threat-intel-head {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 14px;
  margin-bottom: 0;
  position: relative;
  z-index: 1;
}

.threat-intel-head > div:first-child {
  flex: 1;
  min-width: 0;
}

.threat-intel-head > div:first-child .small {
  display: block;
  margin-top: 4px;
  max-width: 64ch;
  line-height: 1.45;
}

.threat-intel-head h2 {
  margin: 0;
  line-height: 1.2;
}

.threat-intel-kicker {
  margin: 0 0 6px;
  color: #89d7ff;
  font-size: 0.75rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.threat-intel-meta {
  display: grid;
  gap: 5px;
  justify-items: end;
  flex-shrink: 0;
}

.threat-source-tag {
  border: 1px solid rgb(125 211 252 / 36%);
  background: rgb(2 24 46 / 68%);
  color: #dbeafe;
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 0.75rem;
  font-weight: 600;
}

.threat-intel-controls {
  display: grid;
  grid-template-columns: auto minmax(120px, 180px) auto minmax(140px, 220px);
  gap: 8px 10px;
  align-items: center;
  margin-bottom: 0;
  position: relative;
  z-index: 1;
}

.threat-intel-controls .small { font-weight: 600; color: #d4e7ff; }

.threat-intel-card #threat-feed-status {
  display: block;
  margin: 0;
  padding: 2px 0 4px;
  border: none;
  border-radius: 0;
  background: transparent;
  color: #b7d5f8;
  line-height: 1.4;
  position: relative !important;
  inset: auto !important;
  z-index: 1;
}

.threat-feed-list {
  display: grid;
  gap: 10px;
  min-height: 180px;
}

.threat-feed-item {
  border: 1px solid rgb(125 211 252 / 18%);
  background: linear-gradient(165deg, rgb(13 28 50 / 58%), rgb(8 16 30 / 90%));
  border-radius: 12px;
  padding: 11px 12px;
  display: grid;
  gap: 8px;
  transform: translateY(6px);
  opacity: 0;
  animation: threat-entry 320ms ease forwards;
}

.threat-feed-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.threat-feed-title {
  margin: 0;
  font-size: 0.98rem;
  line-height: 1.35;
  letter-spacing: -0.01em;
}

.threat-feed-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  align-items: center;
}

.threat-meta-chip {
  border: 1px solid rgb(125 211 252 / 24%);
  background: rgb(8 26 46 / 62%);
  color: #cde5ff;
  border-radius: 999px;
  padding: 2px 9px;
  font-size: 0.72rem;
  line-height: 1.4;
}

.threat-meta-time { color: #9fb4d1; }

.threat-feed-icon {
  width: 26px;
  height: 26px;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 0.84rem;
  background: rgb(2 22 41 / 80%);
  border: 1px solid rgb(125 211 252 / 28%);
}

.threat-feed-state {
  border: 1px dashed rgb(125 211 252 / 28%);
  border-radius: 12px;
  padding: 16px;
  color: #d5e8ff;
  background: rgb(8 19 35 / 52%);
}

.threat-feed-skeleton {
  border-radius: 12px;
  border: 1px solid rgb(125 211 252 / 16%);
  background: linear-gradient(165deg, rgb(14 31 54 / 44%), rgb(9 17 30 / 82%));
  padding: 11px 12px;
}

.threat-feed-skeleton .line {
  height: 10px;
  border-radius: 999px;
  margin-bottom: 8px;
  background: rgb(153 199 255 / 16%);
}

.threat-feed-skeleton .line:last-child { margin-bottom: 0; width: 56%; }

.threat-intel-footer { margin-top: 12px; display: flex; justify-content: flex-end; }
.threat-intel-cta:focus-visible,
.threat-intel-controls select:focus-visible {
  outline: 2px solid #67e8f9;
  outline-offset: 2px;
}

@keyframes threat-entry {
  to { transform: translateY(0); opacity: 1; }
}

.calculator-result { font-size: 1.2rem; font-weight: 700; color: var(--cl-brand-blue); }
.nav-cta-secondary { margin-left: 8px; }

@media (max-width: 1024px) {
  .soc-preview-page .split-grid,
  .soc-preview-page .form-grid-inline,
  .soc-preview-page .map-controls-grid,
  .soc-preview-page .map-live-metrics {
    grid-template-columns: 1fr;
  }

  .soc-preview-page .threat-map {
    min-height: 270px;
    height: 48vh;
  }
}

@media (max-width: 768px) {
  .soc-preview-page .kpis { grid-template-columns: 1fr; }
  .soc-preview-page .panel-head { flex-direction: column; align-items: flex-start; }
  .soc-preview-page .page-hero { padding: 72px 0 40px; }

  .threat-intel-head {
    flex-direction: column;
    align-items: flex-start;
  }

  .threat-intel-meta { justify-items: start; }

  .threat-intel-controls {
    grid-template-columns: 1fr;
    gap: 6px;
  }

  .threat-intel-footer { justify-content: stretch; }
  .threat-intel-footer .btn { width: 100%; text-align: center; }
}

@media (prefers-reduced-motion: reduce) {
  .soc-preview-page .map-node-origin,
  .soc-preview-page .loading-skeleton::after,
  .soc-preview-page .bar,
  .soc-preview-page .list-item,
  .threat-feed-item {
    animation: none;
    transition: none;
  }
}

/* ===== Global premium expansion styles ===== */
.page-hero,
.hero {
  padding: clamp(64px, 8vw, 108px) 0 clamp(28px, 4vw, 52px);
  background:
    radial-gradient(circle at 4% 8%, rgba(255, 102, 0, 0.14), transparent 28%),
    radial-gradient(circle at 90% 4%, rgba(2, 148, 213, 0.2), transparent 32%),
    linear-gradient(120deg, #090f1a, #0c1728 60%, #101d32);
  border-bottom: 1px solid rgba(255,255,255,0.08);
}

.page-hero h1,
.hero h1 {
  font-size: clamp(2rem, 4.2vw, 3.2rem);
  letter-spacing: -0.03em;
  line-height: 1.08;
  margin-bottom: 12px;
}

.page-hero p,
.hero p,
.hero .lead {
  color: var(--text-muted);
  max-width: 70ch;
}

.section-block,
.content-section {
  padding: clamp(22px, 3vw, 38px) 0;
}

.card,
.kpi,
.list-item,
.pricing-card,
.soc-preview-page .card {
  background: linear-gradient(165deg, rgba(17, 30, 50, 0.8), rgba(9, 16, 28, 0.9));
  border: 1px solid rgba(125, 211, 252, 0.2);
  box-shadow: 0 16px 40px rgba(2, 6, 23, 0.38);
  backdrop-filter: blur(10px);
}

.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 16px;
}

.form-grid {
  display: grid;
  gap: 14px;
}

.form-grid label {
  display: grid;
  gap: 6px;
  font-weight: 600;
  color: #e6f2ff;
}

.input,
input,
select,
textarea {
  width: 100%;
  border-radius: 10px;
  border: 1px solid rgba(125, 211, 252, 0.3);
  background: rgba(7, 16, 31, 0.92);
  color: #eaf3ff;
  padding: 11px 12px;
}

.small { color: var(--text-muted); }

.portal-page .portal-shell {
  max-width: 1080px;
  margin: 0 auto;
  display: grid;
  gap: 18px;
  grid-template-columns: 1.1fr .9fr;
}

.portal-page .portal-auth-card {
  padding: clamp(18px, 2.4vw, 28px);
}

.portal-status {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: .88rem;
  border: 1px solid rgba(2, 148, 213, .45);
  background: rgba(2, 148, 213, .12);
  border-radius: 999px;
  padding: 5px 10px;
}

.portal-result[data-state='error'] { color: #ff9aa9; }
.portal-result[data-state='success'] { color: #87f7b2; }
.portal-result[data-state='loading'] { color: #c9e9ff; }

@media (max-width: 900px) {
  .portal-page .portal-shell { grid-template-columns: 1fr; }
}